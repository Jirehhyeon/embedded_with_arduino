# 🔌 스마트 선풍기 상세 회로도

## 📋 전체 시스템 구성도

```
                    🌐 WiFi/Bluetooth 연결
                           ↓
    ┌─────────────────────────────────────────────────────────────┐
    │                   스마트 선풍기 제어 시스템                      │
    │                                                             │
    │  📱 모바일 앱 ←→ 🌐 ESP32 ←→ 🔧 Arduino Uno ←→ ⚡ HW-020   │
    │                      ↕                    ↕           ↕      │
    │              🌡️ 온습도 센서        📊 LCD 디스플레이   🌀 12V 모터 │
    └─────────────────────────────────────────────────────────────┘
```

## 🔧 상세 회로 연결도

### 메인 제어 시스템
```
                Arduino Uno R3
    ┌─────────────────────────────────────┐
    │  USB  ○ ○  POWER                   │
    │       ○ ○  RESET                   │ 
    │                                    │
    │  DIGITAL (PWM~)                    │
    │    0  RX  ●─────────────────────────┼──► 🌐 ESP32 (TX)
    │    1  TX  ●─────────────────────────┼──► 🌐 ESP32 (RX)  
    │    2~ INT ●─────────────────────────┼──► 🔘 비상정지 버튼
    │    3~ PWM ●─────────────────────────┼──► ⚡ HW-020 ENA (PWM)
    │    4     ●─────────────────────────┼──► 🟢 전원 LED
    │    5~    ●─────────────────────────┼──► 🟡 경고 LED  
    │    6~    ●─────────────────────────┼──► 🔴 상태 LED
    │    7     ●─────────────────────────┼──► 🌡️ DHT22 (Data)
    │    8     ●─────────────────────────┼──► 🔔 부저 (+)
    │    9~    ●─────────────────────────┼──► 🎛️ 서보모터 (Signal)
    │   10~    ●─────────────────────────┼──► 📱 ESP32 EN Pin
    │   11~ PWM●─────────────────────────┼──► 예비 PWM
    │   12     ●─────────────────────────┼──► ⚡ HW-020 IN1 (DIR)
    │   13 LED ●─────────────────────────┼──► 💡 내장 LED
    │                                    │
    │  ANALOG IN                         │
    │    A0    ●─────────────────────────┼──► 🎛️ 속도 포텐셔미터
    │    A1    ●─────────────────────────┼──► ⚡ ACS712 전류센서
    │    A2    ●─────────────────────────┼──► 💡 조도센서 (LDR)
    │    A3    ●─────────────────────────┼──► 🔊 마이크 센서
    │    A4    ●─────────────────────────┼──► 📊 LCD SDA (I2C)
    │    A5    ●─────────────────────────┼──► 📊 LCD SCL (I2C)
    │                                    │
    │  POWER                             │
    │   3.3V   ●─────────────────────────┼──► 🌐 ESP32 VCC
    │   5V     ●─────────────────────────┼──► 🌡️ 센서들 전원
    │   GND    ●─────────────────────────┼──► ⚫ 공통 접지
    │   VIN    ●─────────────────────────┼──► ⚡ 12V 입력
    └─────────────────────────────────────┘
```

### HW-020 모터 드라이버 쉴드
```
                    HW-020 Motor Shield
    ┌─────────────────────────────────────────────────────┐
    │                                                     │
    │  INPUT (Arduino에서)          OUTPUT (모터로)        │
    │  ┌─────────────────────┐      ┌─────────────────────┐ │
    │  │  ENA (PWM) ←─ D3   │      │  OUT1 → 🌀 Motor + │ │
    │  │  IN1 (DIR) ←─ D12  │      │  OUT2 → 🌀 Motor - │ │
    │  │  IN2 (DIR) ←─ 예비  │      │  OUT3 → 예비        │ │  
    │  │  ENB (PWM) ←─ 예비  │      │  OUT4 → 예비        │ │
    │  └─────────────────────┘      └─────────────────────┘ │
    │                                                     │
    │  POWER INPUT                                        │
    │  ┌─────────────────────────────────────────────────┐ │
    │  │  VCC ←─ 12V 어댑터 (+)                          │ │
    │  │  GND ←─ 12V 어댑터 (-) & Arduino GND          │ │
    │  └─────────────────────────────────────────────────┘ │
    └─────────────────────────────────────────────────────┘
```

## 🌐 ESP32 WiFi 모듈 연결

### ESP32 DevKit 핀아웃
```
                    ESP32 DevKit v1
    ┌─────────────────────────────────────────────────┐
    │  3V3  ●─────────────────────────────────── ●  VIN│
    │  GND  ●─────────────────────────────────── ●  GND│
    │  D15  ●                                    ●  D13│
    │  D2   ●                                    ●  D12│
    │  D4   ●                                    ●  D14│  
    │  D16  ●                                    ●  D27│
    │  D17  ●                                    ●  D26│
    │  D5   ●                                    ●  D25│
    │  D18  ●                                    ●  D33│
    │  D19  ●                                    ●  D32│
    │  D21  ●                                    ●  D35│
    │  RX2  ●─────┬─────── Arduino TX (D1)     ●  D34│
    │  TX2  ●─────┼─────── Arduino RX (D0)     ●  VN │
    │  D22  ●     │                            ●  VP │
    │  D23  ●     │ 📡 Serial Communication    ●  EN │←─ Arduino D10
    └─────────────┼────────────────────────────────────┘
                  │
                  └──► 🌐 WiFi/Bluetooth 통신
```

## 🌡️ 센서 시스템 배치도

### DHT22 온습도 센서
```
           DHT22 온습도 센서
    ┌─────────────────────────────┐
    │   (앞면 - 격자 부분)          │
    │                             │
    │  ┌───┐ ┌───┐ ┌───┐ ┌───┐   │
    │  │ 1 │ │ 2 │ │ 3 │ │ 4 │   │
    │  └─┬─┘ └─┬─┘ └─┬─┘ └─┬─┘   │
    └────┼─────┼─────┼─────┼───────┘
         │     │     │     │
         │     │     │     └─── 사용안함
         │     │     └─────────── GND → Arduino GND
         │     └───────────────── Data → Arduino D7
         └─────────────────────── VCC → Arduino 5V
```

### ACS712 전류 센서
```
           ACS712-05B 전류 센서
    ┌─────────────────────────────────────┐
    │                                     │
    │  VCC ●────────────── Arduino 5V     │
    │  GND ●────────────── Arduino GND    │
    │  OUT ●────────────── Arduino A1     │
    │                                     │
    │   IP+ ●───┬──── 모터 양극선          │
    │   IP- ●───┼──── 모터로 연결          │
    │           │                         │
    └───────────┼─────────────────────────┘
                │
                └──► 🌀 12V 선풍기 모터
```

### I2C LCD 디스플레이
```
            16x2 I2C LCD 디스플레이
    ┌─────────────────────────────────────────┐
    │ ■■■■■■■■■■■■■■■■ ← LCD 화면  │
    │ ■■■■■■■■■■■■■■■■              │
    │                                     │
    │  GND ●─────────── Arduino GND       │
    │  VCC ●─────────── Arduino 5V        │  
    │  SDA ●─────────── Arduino A4        │
    │  SCL ●─────────── Arduino A5        │
    └─────────────────────────────────────────┘
```

## 🔊 오디오 및 입력 시스템

### 부저 및 마이크
```
     🔔 능동 부저                   🎤 마이크 센서
    ┌─────────────┐                ┌─────────────────┐
    │      +      │                │  VCC ●── 5V     │
    │     ~~~     │                │  GND ●── GND    │  
    │      -      │                │  OUT ●── A3     │
    └──┬─────┬────┘                └─────────────────┘
       │     │
       │     └── GND
       └── Arduino D8
```

### 사용자 입력 인터페이스
```
    🎛️ 속도 포텐셔미터              🔘 비상정지 버튼
    ┌─────────────────┐             ┌─────────────────┐
    │                 │             │        O        │
    │     ╭─────╮     │             │    ┌───────┐    │
    │     │  ●  │     │             │    │ PUSH  │    │
    │     ╰─┬─┬─╯     │             │    └───┬───┘    │
    └───────┼─┼───────┘             └────────┼────────┘
            │ │                              │
         GND│ │5V                           │
            └─┼── Arduino A0                └── Arduino D2
              │                              (인터럽트)
           Wiper
```

## 💡 LED 상태 표시 시스템

### LED 배치도
```
                LED 상태 표시판
    ┌─────────────────────────────────────────────┐
    │                                             │
    │   🟢 전원 LED     🟡 경고 LED     🔴 상태 LED   │
    │      │              │              │       │
    │     D4 ←── 220Ω ──  D5 ←── 220Ω ── D6      │
    │      │              │              │       │
    │      └─── Arduino ──┴─── Arduino ──┴───    │
    │                                             │
    │  🟢 = 정상 동작    🟡 = 경고      🔴 = 오류   │
    └─────────────────────────────────────────────┘
```

## ⚡ 전원 공급 시스템

### 전원 분배도
```
                    전원 공급 시스템
    ┌─────────────────────────────────────────────────────┐
    │                                                     │
    │   12V 2A 어댑터                                     │
    │        │                                            │
    │        ├── HW-020 VCC (모터 전원)                   │
    │        │                                            │
    │        ├── Arduino VIN ── 내부 레귤레이터 ── 5V 출력  │
    │        │                       │                    │
    │        │                       ├── DHT22 (5V)      │
    │        │                       ├── LCD (5V)        │
    │        │                       ├── 센서들 (5V)      │
    │        │                       │                    │
    │        │                       └── ESP32 (3.3V)    │
    │        │                                            │
    │        └── 공통 GND ───┬─── Arduino GND            │
    │                        ├─── HW-020 GND             │
    │                        ├─── 모든 센서 GND          │
    │                        └─── ESP32 GND              │
    └─────────────────────────────────────────────────────┘
```

## 🌀 모터 및 제어 시스템

### 12V 선풍기 모터 연결
```
                12V DC 선풍기 모터
    ┌─────────────────────────────────────┐
    │                                     │
    │        🌀 프로펠러                   │
    │           │                         │
    │    ┌──────┴──────┐                  │
    │    │   DC 모터    │                  │
    │    │             │                  │
    │    │  +12V  GND  │                  │
    │    └───┬────┬────┘                  │
    │        │    │                       │
    └────────┼────┼───────────────────────┘
             │    │
             │    └── HW-020 OUT2 (-)
             └── HW-020 OUT1 (+)
```

### 서보 모터 (풍향 조절)
```
                SG90 서보 모터
    ┌─────────────────────────────────────┐
    │                                     │
    │       🔄 회전 축                     │
    │          │                          │
    │    ┌─────┴─────┐                    │
    │    │ SG90 서보 │                    │
    │    │           │                    │
    │    │ PWM 5V GND│                    │
    │    └─┬───┬───┬─┘                    │
    │      │   │   │                      │
    └──────┼───┼───┼──────────────────────┘
           │   │   │
           │   │   └── Arduino GND
           │   └── Arduino 5V  
           └── Arduino D9 (PWM)
```

## 📊 실시간 모니터링 시스템

### 데이터 흐름도
```
    센서 데이터 ─→ Arduino ─→ 처리 ─→ 디스플레이
         │                           │
         ├── 온도/습도                ├── LCD 화면
         ├── 전류 측정                ├── LED 상태
         ├── 조도 감지                ├── 부저 알림
         └── 소음 감지                └── 시리얼 출력
                     │
                     ↓
              ESP32 WiFi 전송
                     │
                     ↓
               📱 모바일 앱
```

## 🔒 안전 시스템 회로

### 다중 보호 회로
```
                안전 보호 시스템
    ┌─────────────────────────────────────────────┐
    │                                             │
    │  🔴 비상정지 ──→ 인터럽트 D2 ──→ 즉시 차단   │
    │                                             │
    │  ⚡ 전류센서 ──→ A1 ──→ 과전류 감지 (1.5A)  │
    │                                             │
    │  🌡️ 온도센서 ──→ 과열 감지 (60°C)         │
    │                                             │
    │  ⏰ 타이머 ──→ 운행시간 제한 (2시간)        │
    │                                             │
    │  📊 전압감시 ──→ 저전압 보호 (4.5V)         │
    └─────────────────────────────────────────────┘
```

## 📐 PCB 레이아웃 권장사항

### 부품 배치 계획
```
    ┌─────────────────────────────────────────────────┐
    │  [전원부]     [제어부]      [센서부]    [출력부]  │
    │                                                 │
    │  12V 어댑터   Arduino      DHT22       HW-020   │
    │     │         Uno R3        │          모터쉴드  │
    │     │          │            │             │     │
    │  레귤레이터     │         조도센서         │     │
    │     │          │            │             │     │
    │  커패시터      LCD         마이크         LED   │ 
    │     │        디스플레이      │           패널    │
    │     │          │            │             │     │
    │  ───┴──────────┴────────────┴─────────────┴───  │
    │                   공통 GND 라인                │
    └─────────────────────────────────────────────────┘
```

## 🔧 조립 순서 및 주의사항

### 1단계: 전원 시스템
1. **12V 어댑터 연결** (극성 주의!)
2. **Arduino VIN, GND 연결**
3. **공통 GND 구성**
4. **전압 측정으로 확인**

### 2단계: 모터 시스템  
1. **HW-020 쉴드 장착**
2. **모터 터미널 연결** (나사 조임 확인)
3. **PWM, 방향 신호선 연결**
4. **저속 테스트**

### 3단계: 센서 시스템
1. **DHT22 온습도 센서**
2. **전류 센서 (직렬 연결)**
3. **조도 센서**
4. **마이크 센서**

### 4단계: 표시 시스템
1. **I2C LCD 연결**
2. **LED 상태 표시등**
3. **부저 연결**

### 5단계: 무선 통신
1. **ESP32 연결**
2. **시리얼 통신 테스트**
3. **WiFi 연결 확인**

## ⚠️ 안전 주의사항

### 전기적 안전
- **극성 확인**: 모든 전원 연결 전 극성 재확인
- **전류 한계**: 20AWG 점퍼선 2A 안전 한계 준수
- **단락 방지**: 연결 후 멀티미터로 단락 검사
- **접지 연결**: 모든 GND 연결 확인

### 기계적 안전  
- **프로펠러 가드**: 회전부 보호 장치 필수
- **고정**: 모든 부품 단단히 고정
- **환기**: 모터 과열 방지용 환기 확보

이 상세한 회로도를 바탕으로 안전하고 효율적인 스마트 선풍기를 제작할 수 있습니다! 🌟